<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mall.repository.basic.mapper.ResourceMapper">

    <resultMap id="ResourceMap" type="com.mall.entity.basic.Resource" autoMapping="true">
        <result column="id" property="id" javaType="String" />
        <result column="defaultIcon" property="defaultIcon" javaType="String" />
        <result column="menu" property="menu" javaType="Integer" />
        <result column="name" property="name" javaType="String" />
        <result column="parentId" property="parentId" javaType="String" />
        <result column="permission" property="permission" javaType="String" />
        <result column="url" property="url" javaType="String" />
        <result column="sorts" property="sorts" javaType="Integer" />
        <result column="status" property="status" javaType="Integer" />
        <result column="type" property="type" javaType="Integer" />
        <result column="hasMenu" property="hasMenu" javaType="String" />
    </resultMap>

    <select id="menuList" resultMap="ResourceMap">
        SELECT
            resource.*
        FROM
            mall_resource resource
        LEFT JOIN mall_role_resource role ON(resource.id = role.resourceId)
        WHERE
            resource.STATUS = #{status} and role.roleId = #{roleId}
            order by id asc
    </select>

    <select id="maxId" resultType="java.lang.String">
        select max(id) from  crm_resource where type = #{type} and parentId = #{parentId}
    </select>

</mapper>
